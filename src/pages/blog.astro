---
/**
 * Blog Page
 *
 * Lists all blog posts with filtering by type.
 * Posts will come from content collections (Phase 7-8).
 */

import BaseLayout from '../layouts/BaseLayout.astro';
import { formatDate } from '../lib/utils';

// Placeholder posts (will be replaced with content collections)
const posts = [
  {
    slug: 'exploring-llm-reasoning',
    title: 'Exploring LLM Reasoning Capabilities',
    description: 'A deep dive into how large language models approach complex reasoning tasks and where they still struggle.',
    date: new Date('2026-01-20'),
    type: 'technical',
    readingTime: '8 min read',
    tags: ['AI', 'LLMs', 'Research'],
  },
  {
    slug: 'monthly-update-january',
    title: 'January 2026: Building in Public',
    description: 'Monthly reflection on what I learned, built, and thought about this month.',
    date: new Date('2026-01-15'),
    type: 'monthly-update',
    readingTime: '5 min read',
    tags: ['Personal', 'Reflection'],
  },
  {
    slug: 'paper-summary-attention',
    title: 'Paper Summary: Attention Is All You Need',
    description: 'Breaking down the transformer architecture that revolutionized natural language processing.',
    date: new Date('2026-01-10'),
    type: 'paper-summary',
    readingTime: '12 min read',
    tags: ['AI', 'Papers', 'NLP'],
  },
  {
    slug: 'building-with-astro',
    title: 'Building a Modern Personal Site with Astro',
    description: 'Why I chose Astro for my personal website and what I learned along the way.',
    date: new Date('2026-01-05'),
    type: 'technical',
    readingTime: '10 min read',
    tags: ['Web Dev', 'Astro', 'Tutorial'],
  },
  {
    slug: 'year-in-review-2025',
    title: 'Year in Review: 2025',
    description: 'Looking back at a year of learning, building, and growing.',
    date: new Date('2025-12-31'),
    type: 'reflection',
    readingTime: '15 min read',
    tags: ['Personal', 'Reflection'],
  },
];

const types = ['all', 'technical', 'paper-summary', 'monthly-update', 'reflection'];

const typeColors: Record<string, string> = {
  'technical': 'var(--color-accent-secondary)',
  'paper-summary': 'var(--color-accent-primary)',
  'monthly-update': 'var(--color-success)',
  'reflection': 'var(--color-accent-tertiary)',
};

const typeLabels: Record<string, string> = {
  'all': 'All Posts',
  'technical': 'Technical',
  'paper-summary': 'Paper Summaries',
  'monthly-update': 'Monthly Updates',
  'reflection': 'Reflections',
};
---

<BaseLayout title="Blog" description="Thoughts on technology, AI, research, and building things - by Aryan Singh">
  <section class="blog-hero">
    <div class="container">
      <header class="blog-hero__content">
        <span class="blog-hero__label">Blog</span>
        <h1 class="blog-hero__title">Writing</h1>
        <p class="blog-hero__description">
          Thoughts on technology, research, and the process of building things.
          From deep technical dives to personal reflections.
        </p>
      </header>
    </div>
  </section>

  <section class="blog-content">
    <div class="container">
      <div class="blog-filter" id="blog-filter">
        {types.map((type) => (
          <button
            class:list={['filter-btn', { 'filter-btn--active': type === 'all' }]}
            data-type={type}
          >
            {typeLabels[type] || type}
          </button>
        ))}
      </div>

      <div class="posts-list" id="posts-list">
        {posts.map((post, index) => (
          <article
            class="post-item"
            data-type={post.type}
            style={`animation-delay: ${index * 50}ms; --type-color: ${typeColors[post.type] || 'var(--color-text-tertiary)'}`}
          >
            <div class="post-item__meta">
              <time datetime={post.date.toISOString()}>{formatDate(post.date)}</time>
              <span class="post-item__divider">/</span>
              <span class="post-item__reading-time">{post.readingTime}</span>
            </div>

            <h2 class="post-item__title">
              <a href={`/blog/${post.slug}`}>{post.title}</a>
            </h2>

            <p class="post-item__description">{post.description}</p>

            <div class="post-item__footer">
              <span class="post-item__type">{typeLabels[post.type] || post.type}</span>
              <div class="post-item__tags">
                {post.tags.slice(0, 3).map((tag) => (
                  <span class="post-item__tag">{tag}</span>
                ))}
              </div>
            </div>
          </article>
        ))}
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  .blog-hero {
    padding: var(--space-4xl) 0 var(--space-2xl);
    text-align: center;
  }

  .blog-hero__content {
    max-width: 700px;
    margin: 0 auto;
  }

  .blog-hero__label {
    display: inline-block;
    font-size: var(--text-sm);
    color: var(--color-accent-primary);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    font-weight: 500;
    margin-bottom: var(--space-sm);
  }

  .blog-hero__title {
    font-size: var(--text-5xl);
    font-family: var(--font-serif);
    margin-bottom: var(--space-lg);
  }

  .blog-hero__description {
    color: var(--color-text-secondary);
    font-size: var(--text-lg);
    line-height: 1.7;
  }

  .blog-content {
    padding: var(--space-2xl) 0 var(--space-4xl);
  }

  .blog-filter {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-sm);
    justify-content: center;
    margin-bottom: var(--space-3xl);
  }

  .filter-btn {
    padding: var(--space-sm) var(--space-lg);
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--color-text-secondary);
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .filter-btn:hover {
    color: var(--color-text-primary);
    border-color: var(--color-accent-primary);
  }

  .filter-btn--active {
    color: white;
    background: var(--color-accent-primary);
    border-color: var(--color-accent-primary);
  }

  .posts-list {
    max-width: 800px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    gap: var(--space-xl);
  }

  .post-item {
    padding: var(--space-xl);
    border-radius: var(--radius-xl);
    border: 1px solid var(--color-border);
    background: var(--color-bg-primary);
    transition: all 0.3s ease;
    animation: fade-in-up 0.5s ease forwards;
    opacity: 0;
  }

  @keyframes fade-in-up {
    to {
      opacity: 1;
      transform: translateY(0);
    }
    from {
      opacity: 0;
      transform: translateY(20px);
    }
  }

  .post-item:hover {
    border-color: var(--type-color);
    transform: translateX(8px);
    box-shadow: -4px 0 0 var(--type-color);
  }

  .post-item__meta {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    font-size: var(--text-sm);
    color: var(--color-text-tertiary);
    margin-bottom: var(--space-sm);
  }

  .post-item__divider {
    opacity: 0.5;
  }

  .post-item__title {
    font-size: var(--text-2xl);
    font-weight: 600;
    margin-bottom: var(--space-sm);
    line-height: 1.3;
  }

  .post-item__title a {
    color: var(--color-text-primary);
    text-decoration: none;
    transition: color 0.2s ease;
  }

  .post-item:hover .post-item__title a {
    color: var(--type-color);
  }

  .post-item__description {
    color: var(--color-text-secondary);
    line-height: 1.6;
    margin-bottom: var(--space-md);
  }

  .post-item__footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: var(--space-md);
  }

  .post-item__type {
    padding: var(--space-xs) var(--space-sm);
    font-size: var(--text-xs);
    font-weight: 500;
    text-transform: capitalize;
    color: var(--type-color);
    border: 1px solid var(--type-color);
    border-radius: var(--radius-md);
  }

  .post-item__tags {
    display: flex;
    gap: var(--space-xs);
  }

  .post-item__tag {
    padding: var(--space-xs) var(--space-sm);
    font-size: var(--text-xs);
    background: var(--color-bg-tertiary);
    border-radius: var(--radius-md);
    color: var(--color-text-secondary);
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const filterContainer = document.getElementById('blog-filter');
    const postsList = document.getElementById('posts-list');

    if (!filterContainer || !postsList) return;

    const filterButtons = filterContainer.querySelectorAll('.filter-btn');
    const postItems = postsList.querySelectorAll('.post-item');

    const filterPosts = (type: string) => {
      postItems.forEach((post, index) => {
        const postElement = post as HTMLElement;
        const postType = postElement.dataset.type;
        const shouldShow = type === 'all' || postType === type;

        if (shouldShow) {
          postElement.style.display = '';
          postElement.style.animation = 'none';
          postElement.offsetHeight;
          postElement.style.animation = '';
        } else {
          postElement.style.display = 'none';
        }
      });

      filterButtons.forEach((btn) => {
        const btnType = (btn as HTMLElement).dataset.type;
        btn.classList.toggle('filter-btn--active', btnType === type);
      });
    };

    filterButtons.forEach((btn) => {
      btn.addEventListener('click', () => {
        const type = (btn as HTMLElement).dataset.type;
        if (type) filterPosts(type);
      });
    });
  });
</script>
